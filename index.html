<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirigiendo a CountAll...</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #121212;
            color: #E0E0E0;
            text-align: center;
        }
        .loader {
            border: 3px solid #333;
            border-top: 3px solid #FFFFFF;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .btn {
            margin-top: 20px;
            padding: 10px 20px;
            background: #FFFFFF;
            color: #121212;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9rem;
            display: none;
        }
    </style>
</head>
<body>
    <div class="loader"></div>
    <p id="msg">Abriendo la aplicaci√≥n...</p>
    <a id="manual-btn" href="#" class="btn">Intentar manualmente</a>

    <script>
        function getCode() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('code');
        }

        const code = getCode();
        const playStoreLink = 'https://play.google.com/store/apps/details?id=com.countall';
        
        // Android Intent for automatic redirection and fallback
        const intentUrl = code 
            ? `intent://contador/${code}#Intent;scheme=countall;package=com.countall;S.browser_fallback_url=${encodeURIComponent(playStoreLink)};end`
            : `intent://open#Intent;scheme=countall;package=com.countall;S.browser_fallback_url=${encodeURIComponent(playStoreLink)};end`;

        const msg = document.getElementById('msg');
        const btn = document.getElementById('manual-btn');

        if (/Android/i.test(navigator.userAgent)) {
            // Automatic attempt
            window.location.href = intentUrl;
            
            // Show manual button as backup
            btn.href = intentUrl;
            setTimeout(() => { btn.style.display = 'inline-block'; }, 2000);
        } else {
            // Not Android? Go straight to Play Store
            window.location.href = playStoreLink;
        }
    </script>
</body>
</html>
